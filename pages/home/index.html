<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="assets/css/style.css">
    <title>Document</title>
</head>

<body>
    <nav>
        <div class="logo">
            <h2>M<span>Shop</span></h2>
        </div>

        <img src="" alt="" srcset="" onclick="abrir_menu()">
        <ul class="lista_menu">
            <!-- <li><a href="#">Inicio</a></li> -->
        </ul>
    </nav>
    <div class="principal">
        <div class="menu open">

        </div>
        <main id="main">
            <form class="search">
                <input name="search" type="search" id="search_input" placeholder="Pesquise por algo aqui...">
                <select name="filter" id="filtro">
                    <option value="Todos" disabled selected>Geral</option>
                </select>
                <button type="submit"></button>
            </form>

            <!-- Banner -->
            <div class="banner">
                <img src="assets/img/nauroo.jpg" alt="Promoção">
                <div class="banner-content">
                    <div class="banner-title">80% DESCONTO</div>
                    <div class="banner-subtitle">Ganhe descontos grandes e ache o ideal para ti</div>
                    <button class="banner-button">Avaliar</button>
                </div>
            </div>
            <div class="container_cards" id="container_cards">
                <div class="list" id="lista_de_cards">

                </div>
            </div>
        </main>
    </div>

    <script src="assets/js/list.js"></script>
    <script src="assets/js/menus.js"></script>
    <script src="assets/js/search.js"></script>

    <script>
        async function carregarProdutos() {
            const resposta = await fetch('get_products.php');
            const produtos = await resposta.json();
            const container = document.getElementById('lista_de_cards');
            container.innerHTML = '';

            produtos.forEach(prod => {
                container.innerHTML += `
                    ${gera_cards(prod.id, prod.nome, "assets/img/folder.jpg);", prod.preco)}
                `;
            
            });
        }
        async function pesquisar_Produtos(conteudo) {
            const resposta = await fetch(`get_products.php?search=${conteudo}`);
            const produtos = await resposta.json();
            const container = document.getElementById('lista_de_cards');
            container.innerHTML = '';

            produtos.forEach(prod => {
                container.innerHTML += `
                    ${gera_cards(prod.id, prod.nome, "assets/img/folder.jpg);", prod.preco)}
                `;
            
            });
            document.querySelector("banner").classList.add("display_none")
        }

        async function favoritarProduto(id_produto) {
            const resp = await fetch('favoritar.php', {
                method: 'POST',
                body: JSON.stringify({
                    id_produto
                }),
                headers: {
                    'Content-Type': 'application/json'
                }
            });
            const data = await resp.json();
            if (data.status === "erro") {
                showToast("Você precisa estar logado para favoritar.", "erro");
                // Opcional: abrir modal de login
            } else {
                showToast("Produto favoritado!", "sucesso");
            }
        }

        document.addEventListener('DOMContentLoaded', carregarProdutos);
    </script>
</body>

</html>